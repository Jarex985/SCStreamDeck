/* generated: pi-function-key.js */
(function(){function l(n){const t=[];return Array.isArray(n)&&n.forEach(n=>{const i=n.label||"Other",r=n.options||[];r.forEach(n=>{const r=String(n.bindingType||"").toLowerCase(),f=r==="mouseaxis"||r==="joystick"||r==="gamepad";if(!f){const e=i,o=String(n.disabledReason||""),u=r==="unbound",s=!!n.disabled&&!u;t.push({value:n.value,legacyValue:n.legacyValue,text:n.text,group:e,details:n.details,bindingType:r,disabledReason:o,unbound:u,disabled:s})}})}),t}function a(n){u=l(n);t?.setItems?.(u);t?.setSelectedValue?.(i,{rerender:!1});i&&s(i)}function o(n,r={}){const u=r.persist!==!1;f=!0;i=n.value;t?.setSelectedValue?.(n.value,{rerender:!0});e(n);u&&c(n.value);setTimeout(()=>{f=!1},200)}function s(n){const t=u.find(t=>t.value===n||t.legacyValue===n);if(t){const i=t.legacyValue===n&&t.value!==n;o(t,{persist:i})}}function e(n){const i=document.querySelector(".pi-details");if(i){if(!n||!n.details){const n=i.querySelector(".pi-details__title");n&&(n.textContent="");const t=document.querySelector(".pi-description__content");t&&(t.textContent="");const r=document.getElementById("pi-details__binding-keyboard"),u=document.getElementById("pi-details__binding-mouse"),f=document.getElementById("pi-details__binding-gamepad"),e=document.getElementById("pi-details__binding-joystick");[r,u,f,e].forEach(n=>{n&&(n.textContent="")});return}const t=n.details,f=String(t.label||n.text||""),e=String(t.description||""),o=Array.isArray(t.devices)?t.devices:[],r=i.querySelector(".pi-details__title");r&&(r.textContent=f);["keyboard","mouse","gamepad","joystick"].forEach(n=>{const t=o.find(t=>t.device&&t.device.toLowerCase()===n.toLowerCase()),i=document.getElementById(`pi-details__binding-${n}`);let r="Unbound";if(t&&Array.isArray(t.bindings)&&t.bindings.length>0){const n=t.bindings.map(n=>String(n.display||n.raw||"")).filter(n=>n);n.length>0&&(r=n.join(", "))}i&&(i.textContent=r)});const u=document.querySelector(".pi-description__content");u&&(u.textContent=e||"No description available.")}}const r=globalThis.SCPI;r?.bus?.start?.();const t=r?.ui?.dropdown?.initDropdown?.({rootId:"functionDropdown",searchEnabled:!0,minLoadingMs:0,successFlashMs:100,emptyText:"No matching functions found",maxResults:50,getText:n=>String(n?.text??""),getValue:n=>String(n?.value??""),getGroup:n=>String(n?.group??""),isDisabled:n=>!!n?.disabled,onSelect:n=>o(n,{persist:!0})});t?.setLoading?.(!0,"Loading functions");let u=[],i="",f=!1;const[h,c]=globalThis.SDPIComponents.useSettings("function",n=>{f||(i=n,s(n))});r?.ui?.filePicker?.createFilePicker?.({rootId:"audioFilePicker",placeholderText:"No file selected",settingsKey:"clickSoundPath"});const n=document.getElementById("resetHoldSeconds");if(n){const i=1,e=.2,o=10,r=document.getElementById("resetHoldSecondsClear");function u(n){const t=typeof n=="number"?n:parseFloat(String(n));return Number.isFinite(t)?Math.min(o,Math.max(e,t)):i}function t(){if(r){const t=u(n.value);r.disabled=Math.abs(t-i)<.0001}}const[s,f]=globalThis.SDPIComponents.useSettings("resetHoldSeconds",i=>{const r=u(i);n.value=r.toFixed(1);t()});r&&r.addEventListener("click",()=>{n.value=i.toFixed(1),f(i),t()});n.addEventListener("input",()=>{t()});n.addEventListener("change",()=>{const i=u(n.value);n.value=i.toFixed(1);f(i);t()});n.value=u(s()).toFixed(1);t()}r?.bus?.on?.(n=>{const i=n?.functionsLoaded;i===!0&&(t?.setLoading?.(!1),document.getElementById("functionDropdown")?.classList.remove("pi-dropdown--error"),a(n.functions||[]));i===!1&&(document.getElementById("functionDropdown")?.classList.add("pi-dropdown--error"),t?.setLoading?.(!0,"No installation detected. Set custom path."),t?.setItems?.([]),e(null))});r?.util?.onDocumentReady?.(()=>{const n=h();n?i=n:e(null);t?.setSelectedValue?.(i,{rerender:!1});r?.bus?.sendOnce?.("pi.connected","propertyInspectorConnected")})})()
